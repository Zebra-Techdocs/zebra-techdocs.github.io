<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>BluetoothPrinterConnection Class</title><link rel="stylesheet" type="text/css" href="../styles/presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="ZSDK_API.Comm" /><meta name="file" content="T_ZSDK_API_Comm_BluetoothPrinterConnection" /><meta name="guid" content="T_ZSDK_API_Comm_BluetoothPrinterConnection" /><xml><MSHelp:Attr Name="AssetID" Value="T:ZSDK_API.Comm.BluetoothPrinterConnection" /><MSHelp:TOCTitle Title="BluetoothPrinterConnection Class" /><MSHelp:RLTitle Title="BluetoothPrinterConnection Class (ZSDK_API.Comm)" /><MSHelp:Keyword Index="A" Term="T:ZSDK_API.Comm.BluetoothPrinterConnection" /><MSHelp:Keyword Index="A" Term="frlrfZSDK_APICommBluetoothPrinterConnectionClassTopic" /><MSHelp:Keyword Index="K" Term="BluetoothPrinterConnection class" /><MSHelp:Keyword Index="K" Term="ZSDK_API.Comm.BluetoothPrinterConnection class" /><MSHelp:Keyword Index="K" Term="BluetoothPrinterConnection class, about BluetoothPrinterConnection class" /><MSHelp:Keyword Index="F" Term="BluetoothPrinterConnection" /><MSHelp:Keyword Index="F" Term="ZSDK_API.Comm.BluetoothPrinterConnection" /><MSHelp:Attr Name="HelpPriority" Value="2" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="ZSDK_API.dll" /><MSHelp:Attr Name="APIName" Value="ZSDK_API.Comm.BluetoothPrinterConnection" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="DevLang" Value="VB" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="Establishes a Bluetooth(R) connection to a printer." /><MSHelp:Attr Name="AssemblyVersion" Value="1.1.123.0" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"></script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span><span>    </span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label></span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">ZebraLink Multiplatform SDK</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">BluetoothPrinterConnection Class</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="AllMembers_T_ZSDK_API_Comm_BluetoothPrinterConnection.htm">Members</a>  <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a>  <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a>  
  <span id="headfeedbackarea" class="feedbackhead">
      <a href="javascript:SubmitFeedback('sdk@zebra.com','ZebraLink Multiplatform SDK','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">
        
        Send Feedback
      </a>
	</span>
</td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"> </span><div class="summary">
             Establishes a Bluetooth(R) connection to a printer.
             </div><p />
    <b>Namespace:</b> 
   <a href="N_ZSDK_API_Comm.htm">ZSDK_API.Comm</a><br />
    <b>Assembly:</b>
   <span sdata="assembly">ZSDK_API</span> (in ZSDK_API.dll) Version: 1.1.123.0<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">BluetoothPrinterConnection</span> : <a href="T_ZSDK_API_Comm_ZebraPrinterConnection.htm">ZebraPrinterConnection</a></pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic (Declaration)</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">BluetoothPrinterConnection</span> _
	<span class="keyword">Implements</span> <a href="T_ZSDK_API_Comm_ZebraPrinterConnection.htm">ZebraPrinterConnection</a></pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="">
             The encryption type and whether or not it is used is determined by the smartphone and not the printer. 
             Note: Some Mobile printers (including the MZ series printers) will not communicate over Bluetooth(R) if the printer is not ready to print. 
             On these printers, status information is not available when, for example, the printer is out of paper.
             </div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style="">The following example demonstrates how to establish and send data via a Bluetooth(R) connection.
             
             <span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><div class="code"><pre><span class="highlight-keyword">using</span> System;
<span class="highlight-keyword">using</span> ZSDK_API.Comm;
<span class="highlight-keyword">using</span> System.Text;
<span class="highlight-keyword">using</span> System.Threading;

<span class="highlight-comment">// This example prints "This is a ZPL test." near the top of the label.</span>
<span class="highlight-keyword">private</span> <span class="highlight-keyword">void</span> SendZplOverBluetooth(String theBtMacAddress) {
    <span class="highlight-keyword">try</span> {
        <span class="highlight-comment">// Instantiate a connection for given Bluetooth(R) MAC Address.</span>
        ZebraPrinterConnection thePrinterConn = <span class="highlight-keyword">new</span> BluetoothPrinterConnection(theBtMacAddress);

        <span class="highlight-comment">// Open the connection - physical connection is established here.</span>
        thePrinterConn.Open();

        <span class="highlight-comment">// Defines the ZPL data to be sent.</span>
        String zplData = <span class="highlight-literal">"^XA^FO20,20^A0N,25,25^FDThis is a ZPL test.^FS^XZ"</span>;

        <span class="highlight-comment">// Send the data to the printer as a byte array.</span>
        thePrinterConn.Write(Encoding.Default.GetBytes(zplData));

        <span class="highlight-comment">// Make sure the data got to the printer before closing the connection</span>
        Thread.Sleep(<span class="highlight-number">500</span>);

        <span class="highlight-comment">// Close the connection to release resources.</span>
        thePrinterConn.Close();

    } <span class="highlight-keyword">catch</span> (Exception e) {

        <span class="highlight-comment">// Handle communications error here.</span>
        Console.Write(e.StackTrace);
    }
}

<span class="highlight-comment">// This example prints "This is a CPCL test." near the top of the label.</span>
<span class="highlight-keyword">private</span> <span class="highlight-keyword">void</span> SendCpclOverBluetooth(String theBtMacAddress) {
    <span class="highlight-keyword">try</span> {
        <span class="highlight-comment">// Instantiate a connection for given Bluetooth(R) MAC Address.</span>
        ZebraPrinterConnection thePrinterConn = <span class="highlight-keyword">new</span> BluetoothPrinterConnection(theBtMacAddress);

        <span class="highlight-comment">// Open the connection - physical connection is established here.</span>
        thePrinterConn.Open();

           <span class="highlight-comment">// Defines the CPCL data to be sent.</span>
        String cpclData = <span class="highlight-literal">"! 0 200 200 210 1\r\n"</span>
                        + <span class="highlight-literal">"TEXT 4 0 30 40 This is a CPCL test.\r\n"</span>
                        + <span class="highlight-literal">"FORM\r\n"</span>
                        + <span class="highlight-literal">"PRINT\r\n"</span>;

        <span class="highlight-comment">// Send the data to the printer as a byte array.</span>
        thePrinterConn.Write(Encoding.Default.GetBytes(cpclData));

        <span class="highlight-comment">// Make sure the data got to the printer before closing the connection</span>
        Thread.Sleep(<span class="highlight-number">500</span>);

        <span class="highlight-comment">// Close the connection to release resources.</span>
        thePrinterConn.Close();

    } <span class="highlight-keyword">catch</span> (Exception e) {

        <span class="highlight-comment">// Handle communications error here.</span>
        Console.Write(e.StackTrace);
    }
}</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VB.NET</div><div class="code"><pre><span class="highlight-keyword">Imports</span> ZSDK_API.Comm
<span class="highlight-keyword">Imports</span> System.Text
<span class="highlight-keyword">Imports</span> ZSDK_API.ApiException
<span class="highlight-keyword">Imports</span> System.Threading
<span class="highlight-comment">'This example prints "This is a ZPL test." near the top of the label.</span>
<span class="highlight-keyword">Private</span> <span class="highlight-keyword">Sub</span> SendZplOverBluetooth(theBtMacAddress <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>])
        <span class="highlight-keyword">Try</span>
            <span class="highlight-comment">' Instantiate a connection for given Bluetooth(R) MAC Address.</span>
              <span class="highlight-keyword">Dim</span> thePrinterConn <span class="highlight-keyword">As</span> ZebraPrinterConnection = <span class="highlight-keyword">New</span> BluetoothPrinterConnection(theBtMacAddress)

            <span class="highlight-comment">' Open the connection - physical connection is established here.</span>
            thePrinterConn.Open()

            <span class="highlight-comment">' Defines the ZPL data to be sent.</span>
            <span class="highlight-keyword">Dim</span> zplData <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] = <span class="highlight-literal">"^XA^FO20,20^A0N,25,25^FDThis is a ZPL test.^FS^XZ"</span>

            <span class="highlight-comment">' Send the data to a printer as a byte array.</span>
            thePrinterConn.Write(Encoding.[<span class="highlight-keyword">Default</span>].GetBytes(zplData))

            <span class="highlight-comment">' Make sure the data got to the printer before closing the connection</span>
            Thread.Sleep(<span class="highlight-number">500</span>)

            <span class="highlight-comment">' Close the connection to release resources.</span>


            thePrinterConn.Close()
        <span class="highlight-keyword">Catch</span> e <span class="highlight-keyword">As</span> Exception

            <span class="highlight-comment">' Handle communications error here.</span>
            Console.Write(e.StackTrace)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">Try</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>

 <span class="highlight-comment">'This example prints "This is a CPCL test." near the top of the label.</span>
    <span class="highlight-keyword">Private</span> <span class="highlight-keyword">Sub</span> SendCpclOverBluetooth(theBtMacAddress <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>])
        <span class="highlight-keyword">Try</span>
            <span class="highlight-comment">' Instantiate a connection for given Bluetooth(R) MAC Address.</span>
            <span class="highlight-keyword">Dim</span> thePrinterConn <span class="highlight-keyword">As</span> ZebraPrinterConnection = <span class="highlight-keyword">New</span> BluetoothPrinterConnection(theBtMacAddress)

            <span class="highlight-comment">' Open the connection - physical connection is established here.</span>
            thePrinterConn.Open()

            <span class="highlight-comment">' Defines the CPCL data to be sent.</span>
            <span class="highlight-keyword">Dim</span> cpclData <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] = <span class="highlight-literal">"! 0 200 200 210 1"</span> &amp; vbCr &amp; vbLf &amp; <span class="highlight-literal">"TEXT 4 0 30 40 This is a CPCL test."</span> &amp; vbCr &amp; vbLf &amp; <span class="highlight-literal">"FORM"</span> &amp; vbCr &amp; vbLf &amp; <span class="highlight-literal">"PRINT"</span> &amp; vbCr &amp; vbLf

            <span class="highlight-comment">' Send the data to printer as a byte array.</span>
            thePrinterConn.Write(Encoding.[<span class="highlight-keyword">Default</span>].GetBytes(cpclData))

            <span class="highlight-comment">'Make sure the data got to the printer before closing the connection</span>
            Thread.Sleep(<span class="highlight-number">500</span>)

            <span class="highlight-comment">' Close the connection to release resources.</span>


            thePrinterConn.Close()
        <span class="highlight-keyword">Catch</span> e <span class="highlight-keyword">As</span> Exception

            <span class="highlight-comment">' Handle communications error here.</span>
            Console.Write(e.StackTrace)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">Try</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(familyToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(familyToggle, event)" tabindex="0"><img id="familyToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Inheritance Hierarchy</span></h1><div id="familySection" class="section" name="collapseableSection" style=""><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span></span>Object</a><br />  <span class="selflink">ZSDK_API.Comm<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span></span>BluetoothPrinterConnection</span><br /></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="AllMembers_T_ZSDK_API_Comm_BluetoothPrinterConnection.htm">BluetoothPrinterConnection Members</a></div><div class="seeAlsoStyle"><a href="N_ZSDK_API_Comm.htm">ZSDK_API.Comm Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss" style="display: none;"> </span>
<p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:sdk%40zebra.com?Subject=ZebraLink Multiplatform SDK">sdk@zebra.com</a>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div></div></body></html>