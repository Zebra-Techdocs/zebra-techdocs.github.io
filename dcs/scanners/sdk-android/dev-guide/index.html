<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Programmers can use these scanner Software Development Kits to build applications.">
        <meta name="author" content="Zebra Technologies">
        <meta name="google-site-verification" content="i4B78BrWnNy8ShJwe5feRW3jO3HE6gfYlYqYbxfl8yY">
        <meta name="msvalidate.01" content="6B651B00161BCE79B8950AC09D5C4C75">
        <meta title="About Scanner SDK for Android">
        <title>Scanner SDK for Android - About - Zebra Technologies</title>
        <!-- core CSS -->
        <link href="/css/bootstrap.min.css" rel="stylesheet">
        <link href="/css/font-awesome.min.css" rel="stylesheet">
        <link href="/css/animate.min.css" rel="stylesheet">
        <link href="/css/owl.carousel.css" rel="stylesheet">
        <link href="/css/owl.transitions.css" rel="stylesheet">
        <link href="/css/prettyPhoto.css" rel="stylesheet">
        <link href="/css/main.css" rel="stylesheet">
        <link href="/css/responsive.css" rel="stylesheet">
        <link href="/css/prettify.css" rel="stylesheet">
        <link href="/css/bootstrap-treenav.min.css" rel="stylesheet">
        <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
        <script src="js/respond.min.js"></script>
        <![endif]--> 
        <script src="//load.sumome.com/" data-sumo-site-id="699cb66cf4dc59352efb45705526d15cbe314e1cd43f7761b94d96f3cf7338e8" async="async"></script>
        <link rel="shortcut icon" href="/favicon.ico">
        <script src="/js/jquery.js"></script>
    </head>
    <body id="home" class="homepage" data-spy="scroll" data-offset="100" data-target="#toc">
        <header id="header">
            <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/">
                            <img src="/images/logo.png" alt="logo" style="max-height:66px;float: inherit; padding-right: 3px;">
                        </a> 
                    </div>
                    <div class="collapse navbar-collapse navbar-left">
                        <ul class="nav navbar-nav">
                            <li class="navbar-text pull-left"><strong>TechDocs</strong></li>
                            <li>
                                <a href="/dcs/scanners">Barcode Scanner Tools</a>
                            </li>
                            <p class="navbar-text">Scanner SDK for Android</p>
                        </ul>
                    </div>
                    <div class="collapse navbar-collapse navbar-right">
                        <ul class="nav navbar-nav">
                            <li>
                                <a href="/dcs/scanners/sdk-android/about">About</a>
                            </li>
                            <li>
                                <a href="/dcs/scanners/sdk-android/get-started">'How To' Videos</a>
                            </li>
                            <li>
                                <a href="/dcs/scanners/sdk-android/dev-guide">Programmer's Guide</a>
                            </li>
                            <li>
                                <a href="/dcs/scanners/sdk-android/samples">Samples</a>
                            </li>
                            <li>
                                <a href="/dcs/scanners/sdk-android/api">APIs</a>
                            </li>
                            <li>
                                <a href="/dcs/scanners/sdk-android/search">
                                    <i class="fa fa-search"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div><!--/.container-->
            </nav><!--/nav-->
        </header><!--/header-->
        <div class="container-fluid">
            <section id="blog">
                <div class="">
                    <section class="content-with-sidebar">
                        <div class="row">
                            <div class="col-sm-3 hidden-sm hidden-xs" id="sidebar">
                                <nav id="toc" data-toggle="toc" data-spy="affix" style="height: 75%; max-width: 225px; overflow-y: auto; ">
                                    <ul class="nav">
                                        <li><strong>Barcode Scanning API Programmer's Guide</strong></li>
                                    </ul>
                                </nav>                    
                                <script type="text/javascript">
                                    $(document).ready(function() {
                        	            $( "#btn_SaveSmartDocOptions" ).click(function() {
                      			            console.log('Saving Options');
                      			            $("#modal-smartdocs").modal({show: false});
                    		            });
                        	            $( "#btn_SaveSmartDocOptions" ).click(function() {
                      			            console.log('Clearing Options');
                      			            $("#modal-smartdocs").modal({show: false});
                    		            });
                                    });
                                </script>
                                <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.css">
                                <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.js"></script>
                                <script type="text/javascript">
                                    $(document).ready(function() {                    
                                    });
                                </script>
                            </div>                
                            <div class="col-sm-9 ">
                                <div class="row">
                                    <div class="col-sm-12">
                                        <section id="cta" class="wow fadeIn">
                                            <div class="">
                                                <h1 id="about-emdk-for-android" class="anchor">
                                                    <a class="heading-anchor" href="#about-emdk-for-android"><span></span></a>Barcode Scanning API Programmer's Guide
                                                </h1>
                                            </div>
                                        </section>                    
                                    </div>
                                </div>
                                <div id="mainContent" class="row">
                                    <div class="col-sm-12">
                                        <div class="blog-post blog-large wow fadeInLeft" data-wow-duration="300ms" data-wow-delay="0ms">
                                            <!-- Start of guide -->
                                            <div class="service-box wow fadeInRight">
                                                <div class="">
                                                    <h2 id="overview" class="anchor"><a class="heading-anchor" href="#overview"><span></span></a>Overview</h2>
                                                    <p>The aim of this guide is to familiarize the user with the Barcode Scanner SDK for Android and its functionalities. Instructions are given in detail about integrating the Barcode Scanner SDK to Android Studio Project and to work with APIs for users to develop their applications. The provided code snippets can benefit the user in implementing LED, Beeper, Firmware Updates etc. Each functionality is explained individually with screenshots where necessary for the easy understanding of the user and to make development with reduced time and effort.</p>
                                                    
                                                    <hr>

                                                    <h2 id="configuredevelopmentenvironment" class="anchor"><a class="heading-anchor" href="#configuredevelopmentenvironment"><span></span></a>Configuring Development Environment</h2>

                                                    <h3 id="addscannersdktoandroidstudio" class="anchor">Adding the Barcode Scanner SDK to the Android Studio Project</h3>

                                                    <p>Add the barcode_scanner_library_vx.x.x.x (ex: barcode_scanner_library_v2.4.10.0) as a Module in your Android Studio Project by navigating to, File -> Project Structure -> Modules</p>

                                                    <div style="display: block; margin: 0 auto; text-align: center;">
                                                        <img src="../../images/android/sdk-dev-guide-1.png" style="display: block; margin: 0 auto;"><strong>Figure 1</strong> Configure Modules in Android Studio 
                                                    </div>

                                                    <p>Click on the '+'' icon to add the 'barcode_scanner_library_vx.x.x.x.aar' file. Then select 'import JAR/AAR Package' and click 'Next'.</p>

                                                    <div style="display: block; margin: 0 auto; text-align: center;">
                                                        <img src="../../images/android/sdk-dev-guide-2.png" style="display: block; margin: 0 auto;"><strong>Figure 2</strong> Select the Module Type 
                                                    </div>

                                                    <p>Locate the Android SDK library package, '.aar' file to add to the project.</p>

                                                    <div style="display: block; margin: 0 auto; text-align: center;">
                                                        <img src="../../images/android/sdk-dev-guide-3.png" style="display: block; margin: 0 auto;"><strong>Figure 3</strong> Locate the Android SDK Library package 'aar' 
                                                    </div>

                                                    <p>After adding the Module successfully, select the Dependencies from the options given. In the Modules section select 'app'. Then in 'Declared Dependencies' section click the '+' icon.</p>

                                                    <div style="display: block; margin: 0 auto; text-align: center;">
                                                        <img src="../../images/android/sdk-dev-guide-4.png" style="display: block; margin: 0 auto;"><strong>Figure 4</strong> Android Studio Project Dependencies 
                                                    </div>

                                                    <p>From the dropdown select 'Module Dependency'.</p>

                                                    <div style="display: block; margin: 0 auto; text-align: center;">
                                                        <img src="../../images/android/sdk-dev-guide-5.png" style="display: block; margin: 0 auto;"><strong>Figure 5</strong> Project Module Selection 
                                                    </div>

                                                    <p>Select the added Module and click 'OK' to proceed.</p>

                                                    <div style="display: block; margin: 0 auto; text-align: center;">
                                                        <img src="../../images/android/sdk-dev-guide-6.png" style="display: block; margin: 0 auto;"><strong>Figure 6</strong> Add Module Dependency 
                                                    </div>

                                                    <h3 id="addpermissioninthemanifestfile" class="anchor">Adding Permissions in the Manifest File</h3>

                                                    <p>Following permissions should be added in the Manifest File in order for the app to establish a Bluetooth connection with the scanner.</p>

<pre class="prettyprint">
<code>
&lt;uses-permission android:name="android.permission.BLUETOOTH" />
&lt;uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />
</code>
</pre>

                                                    <h3 id="connectingthescannertothedevice" class="anchor">Connecting the Scanner to the Device</h3>

                                                    <p>User can make a connection between the scanner and the device using either ‘SSI BT Classic (discoverable)’ Barcode or ‘Scan-To-Connect’ Barcode.</p>

                                                    <p>Using the ‘SSI BT Classic (discoverable)’ barcode (This is available in the Program Reference Guide of the Zebra Scanner Product), a Bluetooth connection can be established with the scanner and the device on which the app is running. Scan the barcode and start a Bluetooth scan in your device. Once the scanner is detected, pair with it.</p>

                                                    <img src="../../images/barcode/SSI_BT_CLASSIC.jpg" style="display: block; margin: 0 auto;" alt="SST BT Classic (Discoverable)"><br />

                                                    <p>The noteworthy difference between the two barcodes is that, Scan-To-Connect doesn’t require setting up the connection manually with the Android device. Unlike 'SSI BT Classic (discoverable)', a one scan of the Scan-To-Connect barcode establishes a connection with both the device and the app in one go.</p>

                                                    <h3 id="sdkinstallation" class="anchor">SDK Installation</h3>

                                                    <p>Inside the 'onCreate' method SDK must be initialized. Out of the several available operational modes (such as <strong>DCSSDK_MODE.DCSSDK_OPMODE_SNAPI, DCSSDK_MODE.DCSSDK_OPMODE_BTLE</strong>), Operational Mode of the Scanner must be set to <strong>DCSSDK_OPMODE_BT_NORMAL</strong>. Even though other operational modes are present, this guide is mainly focused on making a connection via <strong>DCSSDK_OPMODE_BT_NORMAL</strong> and carrying out the functions. Along with the initialization of the SDK an ArrayList to contain scanner information must be created.</p>

<pre class="prettyprint">
<code>
public static SDKHandler sdkHandler;
private ArrayList<DCSScannerInfo> scannerInfoList = new ArrayList<DCSScannerInfo>();
int scannerId;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    sdkHandler = new SDKHandler(this);
    DCSSDKDefs.DCSSDK_RESULT result = sdkHandler.dcssdkSetOperationalMode(DCSSDK_OPMODE_BT_NORMAL);
}
</code>
</pre>

                                                    <h3 id="connectionwiththescanner" class="anchor">Establishing a Connection with the Scanner</h3>
                                                    
                                                    <p>For the ease of explaining, two buttons have been used in the UI to establish the connection with the connected scanner and to make the scanner beep. With the press of the button used for connecting, the following 'connectToScanner' method gets called. If the 'sdkHandler' is not null, 'scannerInfoList' will get filled with all the Scanners that are connected to the device. Here inside the try catch block the 'scanner ID' of the first connected scanner in the 'scannerInfoList' is taken and then 'connectScanner' AsyncTask gets executed. Here an AsyncTask is used to prevent the main thread from being blocked while the scanner connection task is taking place. </p>

                                                    <div style="display: block; margin: 0 auto; text-align: center;">
                                                        <img src="../../images/android/sdk-dev-guide-7.png" style="display: block; margin: 0 auto;"><strong>Figure 7</strong> Demo Application
                                                    </div>

<pre class="prettyprint">
<code>
public void connectToScanner(View view){
    if (sdkHandler != null) {
        sdkHandler.dcssdkGetAvailableScannersList(scannerInfoList);
    }

    try{
        scannerId = scannerInfoList.get(0).getScannerID();
        new connectScanner(scannerId).execute();
    }catch (Exception e){
        Toast.makeText(getApplicationContext(),e.toString(),Toast.LENGTH_SHORT).show();
    }
}
</code>
</pre>

                                                    <p>With 'dcssdkEstablishCommunicationSession' the app makes a connection with the Scanner.</p>

<pre class="prettyprint">
<code>
private class ConnectScanner extends AsyncTask<Void,Integer,Void> {
    int scannerId;
    
    public ConnectScanner(int scannerId){
        this.scannerId=scannerId;
    }

    @Override
    protected Void doInBackground(Void... voids) {
        sdkHandler.dcssdkEstablishCommunicationSession(scannerId);
        return null;
    }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
    }
}
</code>
</pre>

                                                    <h2 id="scannerbeep" class="anchor"><a class="heading-anchor" href="#scannerbeep"><span></span></a>Making the Scanner Beep</h2>

<pre class="prettyprint">
<code>
public void beeperAction(View view) {
    String inXml = "&lt;inArgs>&lt;scannerID>" + scannerId+ "&lt;scannerID>&lt;cmdArgs>&lt;arg-int>"+ 1 +"&lt;arg-int>&lt;cmdArgs>&lt;inArgs>";
    StringBuilder outXml = new StringBuilder();

    new BeepScanner(scannerId, DCSSDKDefs.DCSSDK_COMMAND_OPCODE.DCSSDK_SET_ACTION,outXml).execute(new String[]{inXml});
}
</code>
</pre>

                                                    <p>Here the ‘BeepScanner’ AsyncTask gets called and then the ‘executeCommand’ method gets executed. One has the option to replace 1 in the ‘inXml’ with any integer between 0 and 26 as there are 27 beep combinations available.</p>

                                                    <p>Given below is a code snippet detailing the 27 combinations available for the scanner.</p>

<pre class="prettyprint">
<code>
&lt;resources>
    &lt;string name="app_name">Barcode Scanner SDK - Android&lt;/string>

    &lt;string-array name="beeper_actions">
        &lt;item>One high short beep</item>
        &lt;item>Two high short beeps</item>
        &lt;item>Three high short beeps</item>
        &lt;item>Four high short beeps</item>
        &lt;item>Five high short beeps</item>
        &lt;item>One low short beep</item>
        &lt;item>Two low short beeps</item>
        &lt;item>Three low short beeps</item>
        &lt;item>Four low short beeps</item>
        &lt;item>Five low short beeps</item>
        &lt;item>One high long beep</item>
        &lt;item>Two high long beeps</item>
        &lt;item>Three high long beeps</item>
        &lt;item>Four high long beeps</item>
        &lt;item>Five high long beeps</item>
        &lt;item>One low long beep</item>
        &lt;item>Two low long beeps</item>
        &lt;item>Three low long beeps</item>
        &lt;item>Four low long beeps</item>
        &lt;item>Five low long beeps</item>
        &lt;item>Fast warble beep</item>
        &lt;item>Slow warble beep</item>
        &lt;item>High-low beep</item>
        &lt;item>Low-high beep</item>
        &lt;item>High-low-high beep</item>
        &lt;item>Low-high-low beep</item>
        &lt;item>High-high-low-low beep</item>
    &lt;/string-array>
&lt;resources>
</code>
</pre>

                                                    <p>Inside the 'BeepScanner' AsyncTask, parameters such as 'scannerId', 'opcode', 'outXml' get passed on to the 'executeCommand' method which finally gives out the corresponding beep.</p>

<pre class="prettyprint">
<code>
private class BeepScanner extends AsyncTask&lt;String,Integer,Boolean> {
    int scannerId;
    DCSSDKDefs.DCSSDK_COMMAND_OPCODE opcode;
    StringBuilder outXml;

    public BeepScanner(int scannerId, DCSSDKDefs.DCSSDK_COMMAND_OPCODE opcode, StringBuilder outXml){
        this.scannerId=scannerId;
        this.opcode=opcode;
        this.outXml = outXml;
    }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
    }

    @Override
    protected Boolean doInBackground(String... strings) {
        return  executeCommand(opcode,strings[0],outXml,scannerId);
    }

    @Override
    protected void onPostExecute(Boolean b) {
        super.onPostExecute(b);
    }
}
</code>
</pre>

<pre class="prettyprint">
<code>
public boolean executeCommand(DCSSDKDefs.DCSSDK_COMMAND_OPCODE opCode, String inXml, StringBuilder outXml, int scannerId) {
    if (sdkHandler != null) {
        if(outXml == null) {
            outXml = new StringBuilder();
        }

        DCSSDKDefs.DCSSDK_RESULT result=sdkHandler.dcssdkExecuteCommandOpCodeInXMLForScanner(opCode,inXml,outXml,scannerId);

        if(result== DCSSDKDefs.DCSSDK_RESULT.DCSSDK_RESULT_SUCCESS) {
            return true;
        }
        else if(result== DCSSDKDefs.DCSSDK_RESULT.DCSSDK_RESULT_FAILURE) {
            return false;
        }
    }
    return false;
}
</code>
</pre>

                                                    <h2 id="ledonoff" class="anchor"><a class="heading-anchor" href="#ledonoff"><span></span></a>LED On/Off</h2>

                                                    <p>The following UI is used to explain the LED ON/OFF states of the scanner. Code snippets for establishing a Bluetooth connection with the scanner are given above.</p>

                                                    <div style="display: block; margin: 0 auto; text-align: center;">
                                                        <img src="../../images/android/sdk-dev-guide-8.png" style="display: block; margin: 0 auto;"><strong>Figure 8</strong> Demo Application
                                                    </div>

                                                    <p>The method 'redLedOnClicked' gets called with the press of the 'LED ON' button. Similarly, 'redLedOffClicked' gets called with the press of the button 'LED OFF'.</p>

<pre class="prettyprint">
<code>
public void redLedOnClicked(View view) {
    inXml = prepareInXml(RMDAttributes.RMD_ATTR_VALUE_ACTION_LED_RED_ON);
    performLedAction(inXml);
}
</code>
</pre>

<pre class="prettyprint">
<code>
public void redLedOffClicked(View view) {
    inXml = prepareInXml(RMDAttributes.RMD_ATTR_VALUE_ACTION_LED_RED_OFF);
    performLedAction(inXml);
}
</code>
</pre>

                                                    <p>Using the following code, 'inXml' is created based on the 'RMD attribute value' passed on to it by 'redLedOnClicked' and 'redLedOffClicked' methods.</p>

<pre class="prettyprint">
<code>
private String prepareInXml(int value) {
    inXml = "&lt;inArgs>&lt;scannerID>" + scannerId + "&lt;scannerID>&lt;cmdArgs>&lt;arg-int>" + value + "&lt;arg-int>&lt;cmdArgs>&lt;inArgs>";
    return inXml;
}
</code>
</pre>

<pre class="prettyprint">
<code>
private void performLedAction(String inXml) {
    if (scannerId != -1) {
        new ScannerLed(scannerId, DCSSDKDefs.DCSSDK_COMMAND_OPCODE.DCSSDK_SET_ACTION).execute(new String[]{inXml});
    } 
    else {
        Toast.makeText(this, "Invalid scanner ID", Toast.LENGTH_SHORT).show();
    }
}
</code>
</pre>

                                                    <p>LED ON/OFF takes place when the 'Scanner ID' and the 'opcode' parameters are sent to the 'executeCommand' method.</p>

<pre class="prettyprint">
<code>
private class ScannerLed extends AsyncTask&lt;String,Integer,Boolean> {
    int scannerId;
    DCSSDKDefs.DCSSDK_COMMAND_OPCODE opcode;

    public ScannerLed(int scannerId,  DCSSDKDefs.DCSSDK_COMMAND_OPCODE opcode) {
        this.scannerId=scannerId;
        this.opcode=opcode;
    }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
    }

    @Override
    protected Boolean doInBackground(String... strings) {
        return  executeCommand(opcode,strings[0],null,scannerId);
    }

    @Override
    protected void onPostExecute(Boolean b) {
        super.onPostExecute(b);
    }
}
</code>
</pre>

<pre class="prettyprint">
<code>
public boolean executeCommand(DCSSDKDefs.DCSSDK_COMMAND_OPCODE opCode, String inXml, StringBuilder outXml, int scannerId) {
    if (sdkHandler != null) {
        if(outXml == null) {
            outXml = new StringBuilder();
        }

        DCSSDKDefs.DCSSDK_RESULT result=sdkHandler.dcssdkExecuteCommandOpCodeInXMLForScanner(opCode,inXml,outXml,scannerId);

        if(result== DCSSDKDefs.DCSSDK_RESULT.DCSSDK_RESULT_SUCCESS) {
            return true;
        }
        else if(result== DCSSDKDefs.DCSSDK_RESULT.DCSSDK_RESULT_FAILURE) {
            return false;
        }
    }
    return false;
}
</code>
</pre>

                                                    <h2 id="firmwareupdate" class="anchor"><a class="heading-anchor" href="#firmwareupdate"><span></span></a>Firmware Update</h2>

                                                    <p>Firmware can be updated using '.SCNPLG' files. These plugins can be obtained using the 123Scan Configuration Utility. Once 123Scan is installed, Plugin files for supported scanners can be found in 'C:\ProgramData\123Scan2\Plug-ins'.</p>

                                                    <p>First of all, permissions have to be included in the Manifest file for the device to access firmware files in the storage.</p>

<pre class="prettyprint">
<code>
&lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
&lt;uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
</code>
</pre>

                                                    <p>Secondly, the class 'IDcsSdkApiDelegate' must be implemented. Then the declaration of the String ‘inXml’ must take place.</p>

<pre class="prettyprint">
<code>
public class MainActivity extends AppCompatActivity implements IDcsSdkApiDelegate {
    public static SDKHandler sdkHandler;
    private ArrayList&lt;DCSScannerInfo> scannerInfoList = new ArrayList&lt;DCSScannerInfo>();
    int scannerId;
    String inXml;
}
</code>
</pre>

                                                    <p>The object 'sdkHandler' should be notified of the implemented class. Then it is necessary to subscribe to events in order to be updated when the scanner gets reconnected, especially after a firmware update. The following code snippet takes care of that.</p>

<pre class="prettyprint">
<code>
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    sdkHandler = new SDKHandler(this);
    DCSSDKDefs.DCSSDK_RESULT result = sdkHandler.dcssdkSetOperationalMode(DCSSDK_OPMODE_BT_NORMAL);

    sdkHandler.dcssdkSetDelegate(this);

    int notifications_mask = 0;

    // We would like to subscribe to all scanner available/not-available events
    notifications_mask |= DCSSDKDefs.DCSSDK_EVENT.DCSSDK_EVENT_SCANNER_APPEARANCE.value | DCSSDKDefs.DCSSDK_EVENT.DCSSDK_EVENT_SCANNER_DISAPPEARANCE.value;

    // We would like to subscribe to all scanner connection events
    notifications_mask |= DCSSDKDefs.DCSSDK_EVENT.DCSSDK_EVENT_SESSION_ESTABLISHMENT.value | DCSSDKDefs.DCSSDK_EVENT.DCSSDK_EVENT_SESSION_TERMINATION.value;

    // We would like to subscribe to all barcode events
    notifications_mask |= DCSSDKDefs.DCSSDK_EVENT.DCSSDK_EVENT_BARCODE.value;

    // subscribe to events set in notification mask
    sdkHandler.dcssdkSubsribeForEvents(notifications_mask);
}
</code>
</pre>

                                                    <p>With the implementation of 'IDcsSdkApiDelegate' interface the following methods will be implemented as well.</p>

<pre class="prettyprint">
<code>
@Override
public void dcssdkEventScannerAppeared(DCSScannerInfo availableScanner) {
}

@Override
public void dcssdkEventScannerDisappeared(int scannerId) {
}

@Override
public void dcssdkEventCommunicationSessionEstablished(DCSScannerInfo activeScanner) {
}

@Override
public void dcssdkEventCommunicationSessionTerminated(int scannerId) {
}

@Override
public void dcssdkEventBarcode(byte[] barcodeData, int barcodeType, int fromScannerId) {
}

@Override
public void dcssdkEventFirmwareUpdate(FirmwareUpdateEvent firmwareUpdateEvent){
}

@Override
public void dcssdkEventAuxScannerAppeared(DCSScannerInfo newTopology, DCSScannerInfo auxScanner) {
}

@Override
public void dcssdkEventImage(byte[] imageData, int fromScannerId) {
}

@Override
public void dcssdkEventVideo(byte[] videoFrame, int fromScannerId) {
}

@Override
public void dcssdkEventBinaryData(byte[] binaryData, int fromScannerId) {
}
</code>
</pre>

                                                    <p>Once the 'Update Firmware' button of the given UI is clicked, the following 'updateFirmware' method gets called. Note that the location of the firmware file is given in the 'inXml' String. The 'UpdatingFirmware' 'AsyncTask' gets executed as the next statement fulfilling requested task.</p>

                                                    <div style="display: block; margin: 0 auto; text-align: center;">
                                                        <img src="../../images/android/sdk-dev-guide-9.png" style="display: block; margin: 0 auto;"><strong>Figure 9</strong> Demo Application
                                                    </div>

<pre class="prettyprint">
<code>
public void updateFirmware(View view) {
    try {
        inXml = "&lt;inArgs>&lt;scannerID>" + scannerId + "&lt;scannerID>&lt;cmdArgs>&lt;arg-string>" + "/storage/emulated/0/Download/test.SCNPLG" + "&lt;arg-string>&lt;cmdArgs>&lt;inArgs>";
        new UpdatingFirmware(scannerId, DCSSDKDefs.DCSSDK_COMMAND_OPCODE.DCSSDK_UPDATE_FIRMWARE, null).execute(new String[]{inXml});
    }
    catch (Exception e) {
        Toast.makeText(getApplicationContext(),e.toString(),Toast.LENGTH_SHORT).show();
    }
}
</code>
</pre>

                                                    <p>Finally, 'executeCommand' is called when the 'scannerId','opcode' and 'outXml' are all set.</p>

<pre class="prettyprint">
<code>
private class UpdatingFirmware extends AsyncTask<String,Integer,Boolean> {
    int scannerId;
    StringBuilder outXml;
    DCSSDKDefs.DCSSDK_COMMAND_OPCODE opcode;

    public UpdatingFirmware(int scannerId,  DCSSDKDefs.DCSSDK_COMMAND_OPCODE opcode,StringBuilder outXml) {
        this.scannerId = scannerId;
        this.opcode = opcode;
        this.outXml = outXml;
    }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
    }

    @Override
    protected Boolean doInBackground(String... strings) {
        return  executeCommand(opcode,strings[0],outXml,scannerId);
    }

    @Override
    protected void onPostExecute(Boolean b) {
        super.onPostExecute(b);
    }
}

public boolean executeCommand(DCSSDKDefs.DCSSDK_COMMAND_OPCODE opCode, String inXml, StringBuilder outXml, int scannerId) {
    if (sdkHandler != null) {
        if(outXml == null) {
            outXml = new StringBuilder();
        }
        
        DCSSDKDefs.DCSSDK_RESULT result=sdkHandler.dcssdkExecuteCommandOpCodeInXMLForScanner(opCode,inXml,outXml,scannerId);
        if(result== DCSSDKDefs.DCSSDK_RESULT.DCSSDK_RESULT_SUCCESS) {
            return true;
        }
        else if(result== DCSSDKDefs.DCSSDK_RESULT.DCSSDK_RESULT_FAILURE) {
            return false;
        }
    }
    return false;
}
</code>
</pre>

                                                    <p>Once a firmware update has started, user can be notified of the firmware update events. This is achieved by declaring a 'handler' inside 'dcssdkEventFirmwareUpdate(FirmwareUpdateEvent firmwareUpdateEvent)' method. Integer 'FW_UPDATE_EVENT' must be defined at the beginning of the class.</p>

<pre class="prettyprint">
<code>
public class MainActivity extends AppCompatActivity implements IDcsSdkApiDelegate {
    public static SDKHandler sdkHandler;
    private ArrayList&lt;DCSScannerInfo> scannerInfoList = new ArrayList&lt;DCSScannerInfo>();

    int scannerId;
    String inXml;

    public static final int FW_UPDATE_EVENT = 35;
}
</code>
</pre>

                                                    <p>It is required to use handlers so as not to block the Event thread. With the use of a handler, the main thread will not be halted for the current process to execute. Multiple threads can run parallelly without interrupting each other.</p>

<pre class="prettyprint">
<code>
@Override
public void dcssdkEventFirmwareUpdate(FirmwareUpdateEvent firmwareUpdateEvent) {
    dataHandler.obtainMessage(FW_UPDATE_EVENT,firmwareUpdateEvent).sendToTarget();
}
</code>
</pre>

                                                    <p>Inside the handler, 'firmwareUpdateEvent' parameter gets passed on to the method 'processFirmwareUpdateEvents'.</p>

<pre class="prettyprint">
<code>
protected Handler dataHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        if(msg.what == FW_UPDATE_EVENT) {
            FirmwareUpdateEvent firmwareUpdateEvent=(FirmwareUpdateEvent)msg.obj;
            processFirmwareUpdateEvents (firmwareUpdateEvent);
        }
    }
}
</code>
</pre>

<p>Several types of Firmware Update events are available. Namely <strong>SCANNER_UF_SESS_START, SCANNER_UF_SESS_END, SCANNER_UF_DL_PROGRESS, SCANNER_UF_STATUS, SCANNER_UF_DL_START and SCANNER_UF_DL_END. SCANNER_UF_STATUS</strong> event will only take place in the event of a firmware update error.</p>

<pre class="prettyprint">
<code>
private void processFirmwareUpdateEvents (FirmwareUpdateEvent firmwareUpdateEvent) {
    if(firmwareUpdateEvent.getEventType() == DCSSDKDefs.DCSSDK_FU_EVENT_TYPE.SCANNER_UF_SESS_START) {
        Log.i("ScannerControl","Update Firmware Session Started ! ");
    }

    if(firmwareUpdateEvent.getEventType() == DCSSDKDefs.DCSSDK_FU_EVENT_TYPE.SCANNER_UF_DL_PROGRESS) {
        Log.i("ScannerControl","Update Firmware DL Progress ! ");
    }

    if(firmwareUpdateEvent.getEventType() == DCSSDKDefs.DCSSDK_FU_EVENT_TYPE.SCANNER_UF_SESS_END) {
        try {
            Thread.sleep(1000);
        } 
        catch (InterruptedException e) {
            e.printStackTrace();
        }
        startNewFirmware();
    }
}
</code>
</pre>

                                                    <p>Once the firmware update process is finished, it is required for the firmware to be launched on to the scanner and be rebooted. This is achieved by the code inside the event 'SCANNER_UF_SESS_END'. It is important for the working thread to sleep for a second before rebooting takes place.</p>

<pre class="prettyprint">
<code>
private void startNewFirmware() {
    String inXml = "&lt;inArgs>&lt;scannerID>" + scannerId + "&lt;/scannerID>&lt;/inArgs>";
    StringBuilder outXml = new StringBuilder();

    executeCommand(DCSSDKDefs.DCSSDK_COMMAND_OPCODE.DCSSDK_START_NEW_FIRMWARE, inXml, outXml, scannerId);
    Log.i("ScannerControl","Scanner Rebooted!");
}
</code>
</pre>

                                                    <p>As a final step, a call to 'executeCommand' method is made for the launching of the firmware on to the scanner to be completed. This can be verified with the rebooting beep of the scanner.</p>

<pre class="prettyprint">
<code>
public boolean executeCommand(DCSSDKDefs.DCSSDK_COMMAND_OPCODE opCode, String inXml, StringBuilder outXml, int scannerId) {
    if (sdkHandler != null) {
        if(outXml == null) {
            outXml = new StringBuilder();
        }

        DCSSDKDefs.DCSSDK_RESULT result=sdkHandler.dcssdkExecuteCommandOpCodeInXMLForScanner(opCode,inXml,outXml,scannerId);

        if(result== DCSSDKDefs.DCSSDK_RESULT.DCSSDK_RESULT_SUCCESS) {
            return true;
        }
        else if(result== DCSSDKDefs.DCSSDK_RESULT.DCSSDK_RESULT_FAILURE) {
            return false;
        }
    }
    return false;
}
</code>
</pre>

                                                    <p>After rebooting of the scanner, it will be automatically reconnected to the app if Scan-To-Connect barcode had been used initially to connect the scanner to the app. If the connection had been made with the SSI BT Classic (Discoverable), scanner must be reconnected to the app manually. This can be achieved by pressing the 'connect' button in the UI. Once rebooting is completed and if the 'connect' button of the UI is pressed, the user can be notified of this reconnection by the 'dcssdkEventCommunicationSessionEstablished' event.</p>

<pre class="prettyprint">
<code>
@Override
public void dcssdkEventCommunicationSessionEstablished(DCSScannerInfo activeScanner) {
    Log.i("ScannerControl","Scanner reconnected ! ");
}
</code>
</pre>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </section>    
            <div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
			    <div class="modal-dialog">
				    <div class="modal-content">
					    <div class="modal-header">
						    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
					    </div>
					    <div class="modal-body">
						    <div id="modalImg"></div>
					    </div>
			        </div>
		        </div>
            </div>
        </div>
        <footer id="footer" class="navbar-fixed-bottom">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-10">
                        ZEBRA and the stylized Zebra head are trademarks of Zebra Technologies Corporation, registered in many jurisdictions worldwide. All other trademarks are the property of their respective owners. &copy;2019 Zebra Technologies Corporation and/or its affiliates. All rights reserved. <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/terms-of-use.html">Terms &amp; Conditions</a>
                    </div>
                    <div class="col-sm-2">
                        <ul class="social-icons">
                            <li><a href="http://www.facebook.com/pages/Zebra-Technologies/107703715989073"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/ZebraDevs"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="http://www.youtube.com/zebratechnologies/"><i class="fa fa-youtube"></i></a></li>
                            <li><a href="https://www.linkedin.com/groups?home=&amp;gid=3220074&amp;trk=anet_ug_hm&amp;goback=%2Egmr_3220074"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://github.com/zebra-technologies"><i class="fa fa-github"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer><!--/#footer-->
        <script src="/js/bootstrap.min.js"></script>
        <script src="/js/owl.carousel.min.js"></script>
        <script src="/js/mousescroll.js"></script>
        <script src="/js/smoothscroll.js"></script>
        <script src="/js/jquery.prettyPhoto.js"></script>
        <script src="/js/jquery.isotope.min.js"></script>
        <script src="/js/jquery.inview.min.js"></script>
        <script src="/js/wow.min.js"></script>
        <script src="/js/bootstrap-treenav.min.js"></script>
        <script src="/js/prettify.js"></script>
        <script src="/js/zepto.js"></script>
        <script src="/js/jquery.waterfall.js"></script>   
        <script src="/js/main.js"></script>
        <script type="text/javascript">
            (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
                (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
                e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
            })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

            _st('install','zRzEsAUhWTTkrdEN2YfA','2.0.0');
        </script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-72584442-1', 'auto');
            ga('send', 'pageview');
        </script> 
        <script>
            ChatraID = 'QDvZ76min4DhLW5vJ';
            (function(d, w, c) {
                var n = d.getElementsByTagName('script')[0],
                    s = d.createElement('script');
                w[c] = w[c] || function() {
                    (w[c].q = w[c].q || []).push(arguments);
                };
                s.async = true;
                s.src = (d.location.protocol === 'https:' ? 'https:': 'http:')
                    + '//call.chatra.io/chatra.js';
                n.parentNode.insertBefore(s, n);
            })(document, window, 'Chatra');
        </script>         
    </body>
</html>